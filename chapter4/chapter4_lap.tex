\section{Introduction}
% modeling at different scales for SC-FC relationships
The exploration of structure and function relationships is a fundamental scientific inquiry at all levels of biological organization, and the structure-function relationship of the brain is of immense interest in neuroscience. Attempts at mathematical formulations of neuronal activity began with describing currents traveling through a neuron's membranes and being charged via ion channels \cite{hodgkin_quantitative_1952}. Recently, the focus of computational models have expanded from small populations of neurons to macroscale brain networks, which are now available via diffusion-weighted and functional magnetic resonance imaging (dMRI and fMRI) \cite{bullmore_complex_2009}. Using computational tractography on dMRI images, detailed whole brain white-matter tracts, and their connectivity can be obtained, to yield the brain's structural connectivity (SC). Using correlated activation patterns over time in fMRI data reveals functional connectivity (FC) with high spatial resolution. Such high resolution images of the brain also allowed neuroscientists to label the brain according to anatomical or functional regions of interest (ROIs) \cite{Desikan2006, craddock_whole_2012}. Subsequently, efforts in graph-theoretic modeling have emerged as an effective computational tool to study the brain's SC-FC relationship based on the parcellated brains: ROIs become nodes and connectivity strengths become edges on the graph, while dynamical systems describing neuronal activity are played out on this graph structure \cite{bassett_human_2009,bullmore_complex_2009,cao_topological_2014}.

%%% paragraph on what's been done in graphical modeling
Diverse graph based methods have been employed to relate the brain's SC to FC. Particularly, perturbations and evolution of the structural and functional networks have been investigated using both graph theoretical statistics \cite{chatterjee_understanding_2008, bassett_small-world_2006, he_structural_2008, buckner_molecular_2005, brunel_dynamics_2000, brunel_effects_2001, suarez_linking_2020} as well as network controllability \cite{gu_controllability_2015, muldoon_stimulation-based_2016}. Structurally informed models use graphical representations of the brain's connections to couple anatomically connected neuronal assemblies \cite{Wilson1972, el_boustani_master_2009}, numerical simulations of such neural mass models (NMMs) provides an approximation of the brain's local and global activities, and are able to achieve moderate correlation between simulated and empirical FC \cite{Nunez1974, jirsa_derivation_1997, Valdes1999, honey_predicting_2009, Spiegler2013}. However, approximations through stochastic simulations are unable to provide a closed form solution and inherits interpretational challenges since dynamics is only obtained from iterative optimizations of high dimensional NMM parameters. 

An emergent field of work have suggested low-dimensional processes involving diffusion or random walks on the structural graph as a simple means of simulating FC from SC. These simpler models are equally if not more successful at simulating fMRI FC patterns \cite{abdelnour_network_2014, Atasoy2016} as well as MEG oscillatory patterns \cite{tewarie_how_2019, Raj2020} than conventional NMMs. Lastly, these simpler graph diffusion models, which naturally employ the Laplacian of SC, have been generalized to yield spectral graph models whereby Laplacian eigen-spectra were sufficient to reproduce functional patterns of brain activity, using only a few eigenmodes \cite{Abdelnour2018, Atasoy2016, Raj2020}. Thus, a Laplacian matrix representation of a network can be used to find characteristic properties of the network \cite{Stewart1999}, and its eigenmodes (or spectral basis) are the ortho-normal basis that represent particular patterns on the network. Such spectral graph models are computationally attractive due to low-dimensionality and more interpretable analytical solutions.

%%% paragraph on canonical functional networks + atasoy/ de ville efforts
The SC's Laplacian eigenmodes are therefore emerging as the substrate on which functional patterns of the brain are thought to be established via almost any reasonable process of network transmission \cite{Abdelnour2018, Atasoy2016, robinson_eigenmodes_2016}, and metrics quantifying structural eigenmode coupling strength to functional patterns were also recently introduced \cite{preti_decoupling_2019}. These works mainly focused on replicating canonical functional networks (CFNs), which are stable large scale circuits made up of functionally distinct ROIs distributed across the cortex that were extracted by clustering a large fMRI dataset \cite{Yeo2011}. In \cite{Yeo2011} seven CFNs (these are spatial patterns, not to be confused for the entire network of graph of the connectome) were identified. Hence recent graph modeling work has attempted to address whether these canonical patterns can emerge by only looking at the structural connectivity information of the brain.

%%% Introducing our study
Although spectral graph models have been reasonably successful, they leave several important gaps. First, they accommodate only passive spread, hence are incapable of producing oscillating or traveling phenomena, which are critical properties of brain functional activity. Second, they do not incorporate path delays caused by finite axonal conductance speed of activity propagating through brain networks. Third, they are capable of reproducing only deterministic and steady-state features of empirical brain activity, giving a single predicted FC for a given SC. Hence these models cannot easily explain the substantial variability observed amongst individuals, as well as between different recording session of the same individual. This suggests that simplistic spectral graph models will need to be augmented with a set of richer time- or individual-varying features or parameters in order to make them more realistic. Unfortunately, this is a goal that is at variance with the key attraction of these methods - their parsimony and low-dimensionality.

In this study we propose a novel spectral graph approach that is able to produce a far richer range of functional activity and dynamics without compromising on the simplicity and parsimony of the spectral graph model. We hypothesise that the introduction of realistic path delays and axonal conductance speeds can allow graph spectra to display the kinds of pattern-richness observed in real data. Hence we utilize both the SC connectivity strength matrix as measured by white-matter fiber tract density, as well as the distance matrix as measured by the average white-matter fiber tract distance between pairs of ROIs. We show that the additional distance information allows for examining of network dynamics in the complex domain in terms of a novel complex-valued Laplacian. This approach involves only global model parameters, which between them accommodate a rich diversity of spatiotemporal patterns that are capable of closely reproducing the diversity of spatial patterning seen across a large number of healthy subjects. Through this minimalist complex diffusion model, the characteristic patterns of signal spread described by corresponding complex-valued eigen-spectra can be tuned to exhibit activation patterns resembling human CFNs. We show that the complex approach significantly and consistently exceeds the performance of existing works relating real-valued SC Laplacian's eigen-spectra to measured FC \cite{Atasoy2016, preti_decoupling_2019, Abdelnour2018, honey_predicting_2009}. The introduction of the complex-valued Laplacian and accompanying complex graph diffusion may be an important contribution to the emerging literature on graph models of brain activity, and furthers our understanding of the structure-function relationship in the human brain.

We begin with a general theory of complex graph diffusion incorporating path delays, leading to the emergence of the complex-valued Laplacian. Then we present detailed statistical analysis showing the ability of complex eigenmodes to be tuned by model parameters and reproducing CFNs. We present comparison with the current approach of using real-valued eigenmodes, followed by a detailed Discussion.

\section{Theory}
\label{sec:theory}

\paragraph{Notation.} In our notation, vectors and matrices are represented in \textbf{bold}, and scalars by normal font. We denote frequency of a signal, in Hertz (Hz), by symbol $f$, and the corresponding angular frequency as $\omega = 2 \pi f$. The structural connectivity matrix is denoted by $\bm{C} = c_{l,m}$, consisting of connection strength $c_{l,m}$ between any two pairs of brain regions $l$ and $m$.


\subsection{Network Diffusion of Brain Activity}
For an undirected, weighted graph representation of the structural network $c_{l,m}$, we model the average neuronal activation rate for the $l$-th region as $x_{l}(t)$:

\begin{equation} 
    \label{eq:eq1}
    \frac{dx_{l}(t)}{dt} = -\beta (x_{l}(t) - \alpha \sum_{l \ne m}^{m} c_{l,m} x_{m}(t-\tau^{\nu}_{l,m})) + p_{l}(t)
\end{equation}

Where we have a mean firing rate equation at the $m$-th region controlled by an inverse of the common characteristic time constant $\beta$, and input signals from the $l$-th regions connected to region $m$ are scaled by the connection strengths from $c_{m,l}$ and delayed by $t-\tau^{\nu}_{m,l}$. The term $\tau^{\nu}_{m,l}$ is the delay in seconds obtained from the distance adjacency matrix defined by $\tau^{\nu}_{m,l} = \frac{D_{m,l}}{\nu}$, with $\nu$ representing the conductance speed in the brain's SC network. The global coupling parameter $\alpha$ acts as a controller of weights given to long-range white-matter connections.

The delays between connected brain regions turn into phase shifts in the frequency profiles of the oscillating signals. Thus we obtain the following Fourier transforms from (\ref{eq:eq1}): $\frac{dx_{l}(t)}{dt} \to j\omega X_{l}(\omega)$, $x(t-\tau^{\nu}_{m,l}) \to e^{-j\omega \tau^{\nu}_{m,l}} X_{m}(\omega)$, and the oscillatory frequency $\omega = 2 \pi f$. Applying the listed Fourier transforms to (\ref{eq:eq1}) we can obtain the following:

\begin{equation}
    \label{eq:eq2}
    j\omega X_{l}(\omega) = -\beta (X_{l}(\omega) - \alpha \sum_{m \ne l}{c_{m,l}X_{m}(\omega)\exp{-j \omega \tau^{\nu}_{m,l}}}) + p_{l}(\omega)\\
\end{equation}

We then define a complex connectivity matrix as a function of angular frequency $\omega$ as $\pmb{C}^{*}(\omega)={c_{m,l}\exp{-j \omega \tau^{\nu}_{m,l}}}$. Therefore, a structural connectivity matrix whose nodes are normalized by $\deg_{m} = \sum_{l} c_{ml}$ at frequency $\omega$ can be expressed as:

\begin{equation}
    \label{eq:eq3}
    \pmb{C}(\omega) = diag(\frac{1}{\pmb{\deg}}) \pmb{C}^{*}(\omega)
\end{equation}

Replacing the connectivity term in (\ref{eq:eq2}) with (\ref{eq:eq3}) and adjusting all vector notations into matrix notation, we derive the following equations for network level activity in the frequency domain:

\begin{equation}
    \label{eq:eq4}
    j\omega \pmb{X}(\omega) = -\beta (\pmb{X}(\omega) - \alpha \pmb{X}(\omega) \pmb{C}(\omega)) + \pmb{P}(\omega)
\end{equation}


\begin{equation}
    \label{eq:eq5}
    \pmb{X}(\omega)(j\omega \pmb{I} + \beta (\pmb{I} - \alpha \pmb{C}(\omega)))=  \pmb{P}(\omega)
\end{equation}

\subsection{Complex Laplacian Matrix}
Our goal is to examine the characteristic patterns of diffusion revealed by the structural network's normalized Laplacian matrix. Here, we make use of (\ref{eq:eq3}) to introduce a complex Laplacian matrix that absorbs the network properties of both the structural connectivity matrix as well as the distance adjacency matrix. By substituting the complex Laplacian matrix and rebalancing (\ref{eq:eq5}), we obtain a closed-form solution for $\pmb{\bar{X}}(\omega)$:

% have closed form solution wih X(\omega) on one side
\begin{equation}
\label{eq:eq6}
\pmb{X}(\omega) = (j \omega I + \beta \mathcal{L}(\alpha, k))^{-1} \pmb{P}(\omega)
\end{equation}

In this closed-form solution, we defined a complex Laplacian matrix $\mathcal{L}$ as a function of global coupling strength $\alpha$ and wave number $k$, which facilitates the dynamics and frequency profiles observed on the brain's connectome. Since frequency $\omega$ and transmission speed $\nu$ always occur as a ratio, we define the wave number $k = \frac{\omega}{\nu}$. The wave number represents the spatial frequency of any propagating wave, describing the amount of oscillations per unit distance traveled \cite{French1971}. Then the complex Laplacian matrix $\mathcal{L}$ has the form:

\begin{equation}
    \label{eq:eq7}
    \mathcal{L}(\alpha, k) = \pmb{I} - \alpha \pmb{C}^{*}(k)
\end{equation}

Where $\pmb{I}$ is the identity matrix and $\pmb{C}^{*}(k)$ is the complex connectivity matrix as defined above. While (\ref{eq:eq3}) indicates that the propagating signals in the network is governed by $\mathcal{L}$, the complex Laplacian of the network describes the characteristic patterns of signal spread in a network, and we can obtain these spatial patterns via the decomposition:

\begin{equation}
\label{eq:eq8}
\bm{\mathcal{L}}(\alpha, k) = \sum_{n = 1}^{N} \bm{u}_{n}(\alpha, k)\lambda_{n}(\alpha, k)\bm{u}_{n}^{H}(\alpha, k)
\end{equation}

Where $\lambda_{n}(\alpha, k)$ are the eigenvalues of the complex Laplacian matrix and $\bm{u}_{n}(\alpha, k)$'s are the complex eigenmodes of the complex Laplacian matrix. Here, the entries of the complex Laplace eigenmodes represent the relative amount of activation in each parcellated brain region as controlled by global coupling and wave number parameters.

\begin{figure}[ht!]
  \centering
  \includegraphics[width=\textwidth]{../figures/chapter4/fig1_overview_v4.pdf}
  \caption{The analysis overview.}
  \caption*{Structural connectivity matrix ($C$) and distance adjacency matrix ($D$) were extracted from diffusion MRI derived tractograms, to construct the complex Laplacian of the brain's structural network. An eigen decomposition on the network's complex Laplacian ($\mathcal{L}$) was performed obtain complex structural eigenmodes of the brain ($U$). The spatial similarities were computed between the structural eigenmodes and canonical functional networks in fMRI. Here, as an example, we show brain rendering of the leading eigenmode from the HCP template structural connectome (right column, top) and the canonical visual functional network (right column, bottom).}
  \label{fig:fig1}
\end{figure}

\section{Methods}
\subsection{Structural Connectivity Network Computation} We constructed structural connectivity networks according to the Desikan-Killiany atlas where the brain images were parcellated into 68 cortical regions and 18 subcortical regions as available in the FreeSurfer software \cite{Fischl2002, Desikan2006}. We first obtained openly available diffusion MRI data from the MGH-USC Human Connectome Project to create an average template connectome \cite{McNab2013}. Additionally, we obtained individual structural connectivity networks from 36 subjects' diffusion MRI data. Specifically, \textit{Bedpostx} was used to determine the orientation of brain fibers in conjunction with \textit{FLIRT}, as implemented in the \textit{FSL} software \cite{Jenkinson2012}. Tractography was performed using \textit{probtrackx2} to determine the elements of the adjacency matrix. We initiated 4000 streamlines from each seed voxel corresponding to a cortical or subcortical gray matter structure and tracked how many of these streamlines reached a target gray matter structure. The weighted connection between the two structures $c_{l,m}$ was defined as the number of streamlines initiated by voxels in region $l$ that reach any voxel within region $m$, normalized by the sum of the source and target region volumes. This normalization prevents large brain regions from having extremely high connectivity due to having initiated or received many streamline seeds. Afterwards, connection strengths are averaged between both directions ($c_{l,m}$ and $c_{m,l}$) to form undirected edges. Additionally, to determine the geographic location of an edge, the top 95\% of non-zero voxels by streamline count were computed for both edge directions, the consensus edge was defined as the union between both post-threshold sets.

\subsection{Canonical Functional Networks}
We chose the 7 CFN parcellations mapped by Yeo et al. \cite{Yeo2011} as the functional spatial patterns most frequently visited by the human brain. The brain parcellations were created from fMRI recordings of 1000 young, healthy English speaking adults at rest with eyes open. A clustering algorithm was used to parcellate and identify consistently coupled voxels within the brain volume. The results revealed a coarse parcellation of seven networks: $\pmb{\Psi}_{CFN} = $ \{limbic, default, visual, frontoparietal, somatomotor, ventral attention, dorsal attention\}.

The CFN parcellation was co-registered to brain regions of interest in the gyral based Desikan-Killany atlas \cite{Desikan2006} to match the dimensionality of our complex Laplacian structural eigenmodes. Then spatial activation maps of each canonical network was produced by normalizing the number of voxels per brain region belonging to a specific CFN by the total number of voxels in the brain region of interest (Fig 1). Both the functional networks and the Desikan-Killiany atlas are openly available for download from Freesurfer \cite{Fischl2012} (\url{http://surfer.nmr.mgh.harvard.edu}).

\subsection{Global Parameter Optimization for Structural Eigenmodes}
To ensure that we obtained a globally optimal set of parameters ${\alpha, k}$ that provided a complex Laplacian eigenmode $\pmb{u}_n$ which is the most similar to the spatial pattern of each of the seven $\pmb{\Psi}_{CFN}$, we performed
an optimization of the cost function: $f(\alpha,k,n) = 1- corr(\pmb{\Psi}_{CFN}, \pmb{u}_n(\alpha, k))$ to determine the optimal eigenmode, coupling, and wavenumber for each canonical functional network. We used the "basin-hopping" global optimization technique on this cost function, a robust technique for non-convex cost functions \cite{Wales1997}. This algorithm is able to escape from local minima in the parameter space by accepting and "hopping" to new parameters even if they increase the cost function. The algorithm will accept iterations that decrease the cost function evaluation with a probability of 1, but only accept iterations that do not decrease cost function with a probability of $\exp(\Delta (f)/{T})$, where $\Delta(f)$ is the change in the cost function across successive iterations, and $T$ is a constantly decreasing "temperature" term. Larger $T$ indicates that the algorithm is more willing to accept jumps in cost function evaluation. We initiated the optimization procedure from ten different initial parameter values and selected the best result out of all initialization runs.

\subsection{Similarity Analysis Between Canonical Functional Networks and Combination of Structural Eigenmodes}

Here, we examine whether structural eigenmodes can form a linear basis for activation patterns for canonical functional networks and examine if a cumulative combination of  structural eigenmodes improves the spatial similarity with CFN's when compared to individual structural eigenmodes. For each CFN, we first ordered the eigenmodes based on their individual similarity after global parameter optimization using procedures described in the previous section. For each CFN, we then computed similarity of the optimal linear weighting of sorted individual structural eigenmodes $\mathbf{u}_l$ with $\mathbf{\Psi}_{CFN}$ by cumulatively adding structural eigenmodes ordered by their similarity. We minimized the $L_2-\textrm{norm}$ of $\left\Vert \mathbf{\Psi}_{CFN}-\sum_{l=1}^{N} \mathbf{u}_{l}(\alpha,k) w_{l} \right\Vert$, to obtain the optimal weights $w_l$ and a quantification of spatial patterns obtained by the best cumulative set of eigenmodes.

Spatial similarity of cumulative eigenmodes with CFNs were then computed using both Pearson's (Figure \ref{fig:fig6}) and Spearman's correlations (Figure S2). While Spearman's correlation was appropriate for non-continuous correlative comparisons, its non-linearity due to sorting of values was evident in volatile changes of spatial similarity, and Pearson's correlation provided more stable results.

We repeated the above analysis for both the conventional real-valued Laplacian without frequency and transmission speed tuning, as well as complex Laplacians obtained from randomized connectivity matrices. For random connectivity matrices, we constructed 1000 realizations of random connectivity and distance matrices to allow us to compare and quantify the performance of the brain's structural eigenmodes against eigenmodes of randomized graphs. The random matrices were constructed with the same sparsity as the HCP template connectome, and the elements of the random matrices were assigned by randomly sampling from a distribution that's representative of the mean and variance of the HCP template connectome and distance matrices.

\section{Results}

\subsection{Structural connectivity based functional activation patterns}

\begin{figure}[htbp]
 \centering
 \includegraphics[width = \textwidth]{../figures/chapter4/eigmode_examples2.png}
 \caption{Complex Laplacian eigenmode for different parameter choices.} 
 \caption*{Three representative eigenmodes decomposed from the complex Laplacian with different tuning parameters and three representative eigenmodes decomposed from the real-valued Laplacian without transmission speed and distance delay properties are shown. The top row shows brain renderings of the real Laplacian eigenmodes with coupling strength $\alpha = 1$. Complex Laplacian eigenmodes with high transmission speed approaches extremely small wave number or delays in the network ($\alpha = 1, k = 0.1$), closely resembles the real Laplacian eigenmodes (second row). Complex Laplacian eigenmodes with higher wave numbers with parameters ($\alpha = 1, k = 30$) and ($\alpha = 5, k = 30$) are respectively shown in the third and fourth rows, demonstrating that parameter choice control the spatial distribution of structural eigenmodes.}
 \label{fig:fig2}
\end{figure}

We use the HCP template connectome to demonstrate the wide range of spatial activity patterns achievable by the eigenmodes of the complex Laplacian matrix. The top row of Figure \ref{fig:fig2} shows three exemplary real-valued structural eigenmodes ($\alpha = 1$) without frequency and transmission speed tuning. Consistent with previous works, we see the Laplace eigenmodes of the human structural connectome display a wide range of cortical activity patterns \cite{Abdelnour2018, Atasoy2016}. As a comparison, we show in the next row complex Laplace eigenmodes with low wave number ($k=0.1$), representing a network with extremely high transmission speed or near zero delay. In such a low delay network, the complex Laplace eigenmdoes closely resemble the spatial patterns seen in real-valued Laplace eigenmodes where delays are not a factor in the network. We also show two additional examples of complex Laplace eigenmodes with higher wave number values, emphasizing the impact of transmission speed and delays in the structural network of the brain. The combination of coupling strength and wave number global parameters enables a richer diversity of spatial cortical patterns, with left and right hemisphere specific activations around the dorsal-caudal brain regions. Despite the increase in model complexity, our approach allows a feature-rich graph theoretics approach to directly infer resting state functional brain patterns from the structural graph of the brain. 

\subsection{Eigenmodes of the complex Laplacian resemble CFN activation patterns}
We re-assigned the voxel-wise parcellations of the seven CFNs from Yeo et al. \cite{Yeo2011} to brain regions from the Desikan-Killiany atlas (Figure \ref{fig:fig3}A, left column), this re-sampling of the parcellations allow spatial pattern comparisons of equal dimensions against our structural connectomes and Laplace eigenmodes. The middle column of Figure \ref{fig:fig3}A shows best matching complex Laplace eigenmodes after optimization of the global parameters with the HCP template connectome to each CFN. In addition to displaying the best-performing eigenmode in each case, we further ranked the eigenmodes according to their spatial correlation values and displayed the best weighted linear combination of the top 10 complex Laplace eigenmodes on the right column of Figure \ref{fig:fig3}A, the corresponding scatter plots showing linear regression fits with 95\% confidence intervals are shown in Figure\ref{fig:fig3}B.  Spatial similarity metrics such as Dice score and Jaccard index were also explored, but such metrics require comparison between binary partitions on images, and are extremely sensitive to the thresholding scheme used for binarizing data. Nonetheless, we found model parameters optimized by the Dice coefficient display similar results as spatial correlation metrics (Figure \ref{fig:S3}). The spatial correlation values of the best performing eigenmode, and details of cumulative combinations of eigenmodes are reported below and in Figure 6. We observe that CFN patterns emerge when parameters, optimized for each network, are applied to the complex Laplacian. Only a few structural eigenmodes are required to capture a specific functional network. 

\begin{figure}[htp]
 \centering
 \includegraphics[width = \textwidth,  height=0.80\textheight]{../figures/chapter4/fig3_revised_scatter_panel.pdf}
 \caption{Canonical functional networks reproduced by structural eigenmodes.}
 \caption*{(A) Renderings of the seven canonical functional networks are shown in the left column. Individual parameter fitted structural eigenmodes with the highest spatial correlation to each functional network are shown in the middle. After ranking all eigenmodes by highest spatial correlation, a linear combination of the top ten best performing eigenmodes are shown in the right column. Parameters producing the best spatial matches to each canonical functional network are listed in the right and applies to all eigenmodes. (B) Top 10 combined structural eigenmodes and canonical functional network comparisons shown in scatter plots with linear regression line and 95\% confidence interval.}
 \label{fig:fig3}
\end{figure}

\subsection{Parameter tuning of complex Laplacian eigenmodes}
To examine the sensitivity of our eigenmodes to our complex Laplacian parameters, we first computed spatial correlation values for the all eigenmodes for each CFN across the entire parameter range. Figure \ref{fig:fig4} (top) shows the effect of fixing $k$ and varying $\alpha$, while bottom row shows the effect of varying $k$ at a fixed $\alpha$. At a glance, almost all eigenmodes are capable of resembling any given CFN with the proper choice of tuning parameters, and it is evident that we need to tune both the global coupling strength and wave number for a dominant eigenmode matching a specific CFN to emerge. For any given CFN, we find parameter regimes that recruit multiple eigenmodes while others recruit a single one. This is especially true of the wave number parameter and not so for coupling strength. Furthermore, the best achievable spatial correlation stay consistent as we tweak the global coupling strength, whereas wave number tuning causes shifts in spatial similarity value and eigenmode occupation. And finally, the limbic network has the lowest spatial  match  and the least a mount of shift in spatial correlation values.

\begin{figure}[htbp]
\centering
\includegraphics[width = 0.75\linewidth]{../figures/chapter4/parameters.pdf}
\caption{Structural eigenmode spatial similarity to canonical functional networks depends on model parameters.}
\caption*{Colors display the spatial correlation values (Spearman's) of all complex Laplacian eigenmodes across all parameter values with each canonical functional network. Shifts in coupling strength ($\alpha$, top, with wave number held constant at $k=10$) does not cause a change in peak spatial correlation, but only in the ordering of the eigenmodes. In contrast, however, shifts in wave number ($k$, bottom), with coupling strength held constant at $\alpha = 1$, leads to changes in eigenmode spatial patterns and spatial correlation to canonical functional networks.}
\label{fig:fig4}
\end{figure}

To further examine the tunable parameter's effects on the leading (best performing) eigenmodes, we show a heat map of the spatial correlation achieved by the dominant eigenmode as we shifted parameter values in Figure \ref{fig:S1}. As expected, global coupling parameter had no effect on dominant eigenmode's fit while the wave number did. Subsequently, we split the wave number parameter into its two components: transmission velocity and oscillating frequency of signals in the network, showing that those two components equally affect spatial patterns emerging from the complex Laplacian eigenmodes (Figure \ref{fig:S1} bottom row). The spatial correlation patterns of each functional network also implies that there are potentially functional network specific eigenmodes obtainable from the structural complex Laplacian, which will be explored further in the subsequent group level analysis.

On the group level, we found parameter sets that provided the most spatially similar complex Laplace eigenmode for each canonical functional network. The rank of the most spatially similar eigenmodes are summarized in violin plots in Figure \ref{fig:fig5}. With  the exception of the default mode network, whose best structural match spans across the range of all eigenmodes, all other canonical functional networks exhibit selectivity towards a specific subset of ranked eigenmodes. The limbic and visual networks, which contains dense connections in the anterior and ventral regions of the brain,  prefer to occupy eigenmodes at both low and high ends of the eigen spectrum. On the other hand, the dorsal and ventral attention networks mainly occupy the middle of the eigen-spectrum. The specific occupancy patterns shown here implies there may be a hierarchy to the functional and structural organization of the brain, and the functioning brain minimizes the recruitment of unrelated structural connections when engaged in conscious brain activity. 

\begin{figure}[ht]
\includegraphics[width = 0.9\linewidth]{../figures/chapter4/eigen_numbers.pdf}
\caption{Canonical functional networks have complex Laplacian eigenmode specificity.}
\caption*{Each dot on the violin plot corresponds to the best performing eigenmode number. Showing that across all subjects ($n = 36$), canonical functional networks occupies specific structural eigenmodes as the dominant structural basis. Default mode network is the exception as the best performing eigenmode spans across all eigenmodes. On the other hand, the rest of the canonical functional networks cluster to specific eigenmode numbers.
}
\label{fig:fig5}
\end{figure}

\subsection{Complex Laplacian eigenmodes outperform real Laplacian eigenmodes}
We created 1000 random realizations of connectivity matrices and their corresponding distance adjacency matrices that share the same sparsity, mean, and standard deviation values as the HCP template connectome values. Comparisons between eigenmodes of the HCP template connectome and randomly generated connectomes are displayed in Figure \ref{fig:fig6}. The Laplace eigenmodes of the brain's white matter network can be seen as individual subsets of cortical activation patterns that make up the brain's functional activity. Therefore, spatial match between cumulative combinations of eigenmodes to each canonical functional network were computed in addition to just the leading eigenmode. 

\begin{figure}[htbp]
\centering
\includegraphics[width = \textwidth]{../figures/chapter4/pearson_residual.png}
\caption{Structural eigenmodes of the HCP template complex Laplacian predict canonical functional networks better than structural eigenmodes of the real Laplacian.}
\caption*{For each canonical functional network, we quantified its spatial similarity against linear combinations of structural eigenmodes obtained from various types of Laplacians. The spatial similarities quantified by linear least squares residuals are shown on top, and Pearson's correlations are shown on the bottom. Overall, accumulation of structural eigenmodes improves the spatial similarity between functional networks and structural eigenmodes. The complex HCP eigenmodes (orange) and real-valued HCP eigenmodes (blue) both outperform eigenmodes decomposed from random connectomes and random distance matrices (green). However, only the complex HCP eigenmodes outperform complex eigenmodes decomposed from the HCP template connectome paired with random distance matrices (magenta).
}
\label{fig:fig6}
\end{figure}

Overall, the HCP complex Laplacian's best-performing eigenmodes achieved higher spatial correlation and lower residuals than other variants of Laplace eigenmodes in 6 out of the 7 CFNs (left-most point on each curve). As more individual eigenmodes are linearly combined, all variants show a steady improvement in spatial similarity, with the fully random variant using the most number of eigenmodes to achieve a high spatial match, suggesting the fully random eigenmodes are the least informative. On the other hand, the complex eigenmodes from randomized distance Laplacians (magenta) consistently performs better than fully random complex eigenmodes (green) but lacks the structural distance information to compete with complex Laplace eigenmodes constructed with HCP template connectivity and distance adjacency matrix. The spatial similarity reported in Figure \ref{fig:fig6} is Pearson's correlation due to its smoothness, we show the same quantification with Spearman's correlation in Figure \ref{fig:S2}, which is more appropriate for discrete samples, but its more volatile due to its nonlinear ordering of samples. 

Spatial similarities from random variants of complex Laplace eigenmodes were normalized into a Z-score distribution for construction of $95\%$ confidence intervals and comparisons against HCP connectome variants. Comparing only the leading eigenmodes without cumulative combinations, Complex Laplacian eigenmodes significantly outperforms random connectivity eigenmodes for all functional network comparisons ($P<0.05$), but only significantly outperforms the randomized distance eigenmodes for the limbic, visual, frontoparietal, and dorsal attention networks. On the other hand, the real-valued Laplace eigenmodes does not significantly outperform eigenmodes from fully random connectivity profiles for all functional networks. The $P$-values for both Pearson's and Spearman's metrics are shown in Supplementary Tables \ref{tab:S1} and \ref{tab:S2}.

\begin{figure}[ht]
\centering
\includegraphics[width = 0.9\linewidth]{../figures/chapter4/group_pearson.png}
\caption{Complex Laplacian outperforms real Laplacian in recapitulating canonical functional networks with individual structural connectomes.}
\caption*{Violin plot showing that on a group level (each dot correspond to one subject, $n = 36$), the best performing structural eigenmodes of the complex Laplacian (orange) outperforms the corresponding structural eigenmode from the real Laplacian (blue) and random distance complex Laplacian (magenta). Paired T-test results of complex Laplacian against either real Laplacian or random distance complex Laplacian shows the complex Laplacians eigenmodes achieving significantly higher spatial similarity on the group level (P-values shown as $* < 0.5, ** < 0.01$).}
\label{fig:fig7}
\end{figure}

\subsection{Group level eigenmode analysis}
Figure \ref{fig:fig7} shows a violin plot of the best spatial correlation achieved by each subject's complex Laplacian in orange, real Laplacian in blue, and random distance adjacency matrix paired with the HCP connectome in magenta. Consistent  with our HCP template connectome analysis, the complex Laplacian eigenmodes outperforms both the real Laplacian eigenmodes and randomized distance complex Laplacian eigenmodes. Our complex Laplacian framework includes the additional distance and delay information in the brain networks compared to conventional real Laplacian eigenmodes, therefore we generated complex Laplacien eigenmodes from HCP structural connectivity paired with random distance adjacency matrices, which as a comparative degree of freedom. Paired T-tests were performed for all CFNs, the complex Laplacian eigenmodes outperformed real Laplcian eigenmodes at the group level for all networks except the limbic network ($p=0.64$). On the other hand, significantly higher spatial similarity was achieved by complex Laplacian eigenmodes for all networks except the dorsal attention network ($p=0.12$) when comparing against the random distance group results.

\section{Discussion}

In this study we have proposed a complex graph Laplacian framework that demonstrates an ability to capture functional connectivity patterns, while maintaining parsimony and low-dimensionality of spectral graph models. The model involves only two global and biophysically meaningful parameters, one controlling the speed of activity propagation, and the other controlling coupling strength between remote populations of neurons connected via axonal projections. The complex Laplacian eigenmodes that emerge from our model are intrinsic properties of the brain's anatomy, which can potentially become a powerful tool in the study of brain networks. However, it is not at all clear if the well-characterized properties of a real valued Laplacian matrix \cite{belkin_laplacian_2003} in the literature can easily translate to its complex counterpart. Questions about the theory and salient properties of the complex Laplacian are important and novel, however, existing literature in this area is limited to exploratory stages, such as the recently published pre-print article on Laplacians and their properties in complex value weighted graphs \cite{dong_complex_2015}. In the current manuscript, we showcased application of the complex Laplacian in brain modeling. We presented detailed statistical analysis of the resulting complex-value Laplacian eigenmodes, focusing on their ability to predict the spatial patterns observed on seven CFNs that are well established in functional neuroimaging. The implications of our main contributions are discussed below, with additional context and relevance to current literature.

\subsection{A simple yet feature-rich graph theoretic approach}
We derived a simple model of network diffusion of activity which takes into account the path delays introduced by realistic axonal conductance speeds and fiber lengths, and showed that at the first order the behavior of the model can be captured within a complex Laplacian, on which a complex-valued graph diffusion process is enacted. Using this definition of the complex Laplacian we demonstrated that its eigenmodes constitute a sparse basis that is capable of reproducing the characteristic spatial patterns of empirical resting state functional activity given by the 7 CFNs.

\subsection{Higher predictive power than existing graph models}
We showed that the complex Laplacian outperforms the existing models that use the eigenmodes of real-valued Laplacian. These results are far better than can be expected by chance, as indicated by the significance values of our results with respect to large simulations with Laplacians calculated from random connectomes. Thus, future graph models can benefit from the enhanced predictive power of the proposed complex Laplacian approach, which in the cases we have tested highly significantly improves performance(see Figure \ref{fig:fig5}). Our work can therefore find direct applicability in many clinical and neuroscientific contexts where predicting functional patterns from structure is important \cite{jiang_brainnetome_2013, fornito_connectomics_2015}, particularly in cases of epilepsy \cite{coan_frequent_2014}, stroke \cite{Kuceyeski2016, rehme_cerebral_2013}, and neurodegeneration \cite{Zimmermann2018}.

\subsection{Complex eigenmodes accommodate a diversity of spatial patterns}
One of the most intriguing aspects of our study is the demonstration that almost all (complex) eigenmodes are capable of resembling any given CFN, with the proper choice of tuning parameters. As observed from Figure \ref{fig:fig4}, certain parameter regimes recruit multiple eigenmodes while others recruit a single one; however with the right selection of the two model parameters, it is possible to "steer" the eigenmodes in such a manner that a small number of them can reproduce any CFN. This not only denotes the strength of our approach, we believe it points to an essential characteristic of real brain activity, which is thought to accommodate a large repertoire of microstates and their concomitant spatial patterns. This rich repertoire was shown above to be capable of being engaged by our parsimonious graph model, which may point to the possibility that complex behavior may be achievable by simple and parsimonious mechanisms, and may not require the kinds of high-dimensional and non-linear oscillatory models that have held sway in the field of neural modeling \cite{honey_predicting_2009, jirsa_derivation_1997}. Our work also supports the idea that macroscopic neurophysiological data on a graph can be sufficiently modeled with linear metrics, and nonlinear methods may not be required for problem of such scale \cite{hlinka_functional_2011, hartman_role_2011}.

\subsection{Rich repertoire is tunable with two biophysical parameters}
In our model, the brain can access any configuration of spatial patterns seen in real resting state functional networks by tuning only two of its global and biophysically meaningful parameters: coupling strength and wave number. Our current work indicates that physical distances and the transmission rate of oscillatory activity in combination with coupling strength is sufficient in generating various canonical functional brain patterns. This demonstration in an analytical model, that a rich repertoire of states is accessible to the brain by tuning biophysical processes, has not previously been reported to our knowledge. The present computational study is not intended to explore the neural mechanisms that might control these parameters. Nevertheless, modern neuroscience provides several potential mechanisms. 

Coupling strength $\alpha$ is a direct scaling of white-matter excitatory long range connections between neural populations in the brain. Phase and amplitude coupling of oscillatory processes in the brain is evidently important for the formation of coherent wide-band frequency profiles of brain recordings and processing of information \cite{fries_mechanism_2005, schnitzler_normal_2005, varela_brainweb_2001, ghosh_cortical_2008, Deco2009}. Parameterization of coupling strength between distant brain regions via the connectome is ubiquitous in connectivity based models of BOLD fMRI \cite{Honey2007, Deco2009, honey_predicting_2009, abdelnour_network_2014} and electroencephalography activity \cite{Ghosh2008, Spiegler2013, david_neural_2003}. Furthermore, pathological FC patterns as a result of disconnections in the brain can be reproduced with decrease in coupling strength \cite{cabral_modeling_2012, Jirsa2010}. 

The other key tunable parameter in our model, wave number $k$, is the ratio between the oscillatory frequency and transmission velocity of a propagating signal, describing the amount of oscillations per unit distance traveled by any signal spreading throughout the brain's structural network. While transmission speed of signals between brain regions is often overlooked in brain modeling efforts, its importance is emphasized by the biology of the central nervous system. Neuronal spike arrival timing at the cellular level and coherent oscillatory activity at the network level are carefully managed by synaptic strengths as well as axonal myelination, respectively \cite{arancibia-carcamo_node_2017, fields_new_2015}. Further, wave number can be controlled not just by conductance speed, but also by the operative frequency of oscillations $\omega$. From the deep literature on wide-band frequency response of brain recordings, it is already known that different functional networks of resting state BOLD data are preferentially encapsulated by different higher-frequency bands via phase- and amplitude-coupling \cite{ghosh_cortical_2008, Deco2009}. Hence it is plausible that wave number tuning may be achieved biologically via either dynamic conductance speed or dynamic control of frequency bands.

\subsection{Relationship to existing studies}

Recent graph models involving eigen spectra of the adjacency or Laplacian matrices of the structural connectome have greatly contributed to our understanding of how the brain's structural wiring gives rise to its functional patterns of activity. Although these models have very attractive features of parsimony and low-dimensionality, they suffer from being feature poor and an inability to make stronger predictions about functional networks. 

Such models mapping between structural and functional patterns of the human brain have typically assumed that SC and FC are not independent entities, and that relationship between the two cannot simply be explained by a direct mapping \cite{honey_predicting_2009}. In addition to connection strength between regions, metrics such as anatomical distances \cite{alexander-bloch_anatomical_2013}, shortest path lengths \cite{goni_resting-brain_2014}, diffusion properties \cite{Abdelnour2018, Kuceyeski2016}, and structural graph degree \cite{stam_relation_2016} were also found to contribute to the brain's observed functional patterns. Higher-order walks on graphs have also been quite successful; typically these methods involve a series expansion of the graph adjacency or Laplacian matrices \cite{Meier2016, Becker2018}. The diffusion and series expansion methods are themselves closely related \cite{robinson_eigenmodes_2016}, and almost all harmonic-based approaches may be interpreted as special cases of each other, as demonstrated elegantly in recent studies \cite{deslauriers2020, tewarie2020}.  The wealth of studies elucidating how the observed function originate from the underlying structural network provided a strong motivation for our approach, which extracts functional patterns from the informative complex graph Laplacian that incorporates both the connection strengths as well as the anatomical distances of the structural network. 

In contrast to spectral graph models, inferring functional connectivity from biophysiological models of neuronal populations have been a specialty of dynamic causal models (DCMs). Such generative models have emerged as powerful tools mainly to infer effective (directional) connectivity for smaller networks \cite{daunizeau_dynamic_2009, stephan_nonlinear_2008, pinotsis_linking_2017, razi_construct_2015, park_dynamic_2018}, or dynamic functional connectivity \cite{preti_dynamic_2017, van_de_steen_dynamic_2019}. While the goal of DCMs is similar to our proposed model that makes model inferences about FC, the two frameworks are different in terms of approach and dimensionality. DCMs examine the second order covariances of brain activity, and it is only recent works with spectral and regression DCM models have expanded the model coverage to the whole-brain scale and the potential to incorporate SC data \cite{frassle_generative_2018, frassle_regression_2017, razi_large-scale_2017}. However, these models rely on formulation of local neural masses to derive dynamical behavior, which are then used to generate effective or dynamic connectivity through simulations. By avoiding large-scale simulations of neuronal activity, in our proposed framework we not only allowed canonical functional patterns to emerge directly from a complex Laplacian matrix, we have also created a model with only two global parameters. Most DCM models have many more degrees of freedom compared to our work because of their parameterization for different interactions within and between brain regions. In contrast to some of more recent spectral DCM parameterizations, additionally, our global parameters reflecting the brain's anatomical connection density and distances traveled between connections continue to have clear biophysical interpretability.

Frequency-band specific magnetoencephalography (MEG) resting-state networks have been successfully modeled with a combination of delayed NMMs and eigenmodes of the structural network \cite{tewarie_how_2019}, suggesting delayed interactions in a brain's network give rise to functional patterns constrained by structural eigenmodes. In our recent work, we expanded upon eigenmdoes of SC matrices by integrating time delays in the brain with SC to create a complex Laplacian matrix in the Fourier domain \cite{Raj2020}. Using the eigen-spectra of the complex Laplacian matrix, we found specific subsets of complex eigenmodes that contributed to specific cortical alpha and beta wave patterns. The findings in the current article expands upon these time-delayed eigenmodes to find subsets of eigenmodes predictive of canonical functional networks derived from resting state fMRI. Our theorized framework provides two global parameters that act on the structural connectome and its corresponding distance adjacency matrix to control coupling strength and delays in the network. These findings supports other works suggesting there is a possible organizational hierarchy, or gradients of topographical organization that spatially constraints cortical function \cite{margulies_situating_2016, sepulcre_stepwise_2012, vazquez-rodriguez_gradients_2019, huntenburg_large-scale_2018, buckner_macroscale_2019}. Margulies et al. proposed that so-called "principal gradients", which may be interpreted as the Laplacian eigenmodes of the FC matrix, serve as the core organizing axis of cerebral cortex, spanning from unimodal sensorimotor to integrative transmodal areas \cite{margulies_situating_2016}. The complex eigenmodes proposed here may therefore be considered as the structural analog of Margulies' principal gradients.

Similarly, we found that the unimodal sensorimotor networks at one end of the principal gradient, which accounts for the most variance in connectivity, achieved the highest spatial correlations. On the other hand, transmodal networks on the opposite end of the axis, needed much more cumulatively combined structural eigenmodes to achieve high spatial similarity. 

Atasoy et al. previously modeled the same resting-state canonical functional networks used here with real-valued Laplacian eigenmodes as structural substrates on which a mean field neural model dictated cortical dynamics \cite{Atasoy2016}. While the model dimensionalities between the two studies are vastly different, we show that in the absence of a neural dynamical system, the addition of time lag in the network allowed canonical functional networks to emerge from just structural substrates. Furthermore, we believe incorporating time lags in our structural connectivity of the brain to create complex Laplacian matrices is an informative but unexplored alternative to regular Laplacian normalizations of brain networks. Particularly, the complex connectivity matrix in Fourier domain allows exploration of oscillatory frequency and phase shifts between brain regions as a property of the network, potentially presenting an opportunity in utilizing complex structural eigenmodes to integrate SC for explaining imaginary coherence patterns in MEG and EEG. 

\subsection{Limitations}
The current results are limited by data resolution. Tractograms obtained from diffusion weighted images are approximations of the brain's axonal white-matter connections. We recognize that tractography, paired with anatomical parcellation of brain regions, does fail to appreciate the finer structures in the brain, especially the more refined connections and nuclei in the brain stem as well as close neighbor connections. Despite the coarse parcellation and rough approximations of white matter architecture, our proposed approach utilizes a spatial embedding of the brain's connectomics information and is extendable to finer parcellations. 

Our theorized model relies on an averaged approximation of fiber distances between ROIs, and we assumed a global parameter to account for conductance speed in the brain. In reality, the amount of myelination and synaptic strength varies greatly in the brain. However, our approximations were enough in recapitulating canonical functional networks in the human brain, while benefiting from a low dimensional and interpretable model. It is also worth nothing that the canonical functional networks used in this work were obtained from data-driven clustering of fMRI activity, and is far from a comprehensive representation of the brain's functional patterns. While our work can be extended to finer functional parcellations, we sought to avoid overlap between canonical functional networks by using the 7 networks parcellation. For example, the dorsal and ventral attention networks are found to overlap with the salience network \cite{seeley_dissociable_2007}, and task activated fMRI patterns revealed regions that are positively and negatively associated with attention and default networks \cite{fox_human_2005}. 

\section{Conclusions}
In conclusion, we show that the spatial embedding of the brain's connections in a structural connectome is a rich substrate, on which we can derive intrinsic functional patterns of the brain with a simple network diffusion approach. We show that Laplace eigenbasis in the complex frequency domain outperforms conventional eigenbasis of the graph Laplacian in capturing spatial patterns of canonical functional networks. We recognize the complex nonlinear activities and dense connections present in the brain, but our work suggests that we can continue to extend simpler linear modeling approaches to approximate what we observe with macroscopic imaging techniques such as BOLD fMRI and diffusion weighted imaging. 